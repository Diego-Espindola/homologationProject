def sql_enderecos(execucaoPrincipal):
    """Funcao que faz a busca das matrículas e retorna um Data Frame"""

    # Query SQL para buscar as matrículas
    sql = f"""
                select 
                    300 as sistema,     
                    (if tipo_endereco = 'P' then 1 else 2 endif) as tipo, 
                    bethadba.dbf_get_id_gerado(sistema, 'municipio', isnull(i_cidades,0)) as cidade,
                    bethadba.dbf_get_id_gerado(sistema, 'logradouro', cidade, isnull(i_ruas, 0)) as "logradouro.id",
                    bethadba.dbf_get_id_gerado(sistema, 'bairro', cidade, isnull(i_bairros, 0)) as "bairro.id",
                    TRIM(isnull(complemento,'')) as complemento,
                    TRIM(isnull(numero,'S/N')) as numero, 
                    TRIM(isnull(cep,'')) as cep
                from bethadba.pessoas_enderecos 
                where cidade is not null and "logradouro.id" is not null and "bairro.id" is not null and i_pessoas = {execucaoPrincipal.i_pessoas}
    """
    return sql