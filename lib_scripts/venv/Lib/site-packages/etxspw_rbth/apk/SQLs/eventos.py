sql_eventos = """ 
            select
                 sistema,  
                 tipo_registro, 
                 i_eventos as chave_dsk1, 
                 i_eventos as codigo,
                 inicioVigenciaataual,
                 nomeOriginal,
                 isnull(CAST(bethadba.dbf_get_id_gerado(sistema, tipo_registro, chave_dsk1) AS INT), 0) as id,
                 nomeEvento,
                 tipo,
                 naturezaRubrica,
                 incidenciaPrevidenciaSocial,
                 incidenciaProcessamentoFerias,
                 incidenciaIrrf,
                 incidenciaFgts,
                 incidenciaContribuicaoSindicalLaboral,
                 incidenciaRpps,
                 classificacao_evento,
                 classificacaoBaixaProvisao,
                 unidade,
                 padrao, 
                 taxa, 
                 ato, 
                 compoemHorasMes = compoe_hmes, 
                 registroDesativado = desativado, 
                 observacao = descricao, 
                 enviaTransparencia = envia_fly,
                 enviaEsocial = enviar_esocial,
                 enviaRais,
                 tiposPrevidencia = left(tiposPrevidencia,length(tiposPrevidencia)-1)     ,     codigoEsocial,
                 tetoRemuneratorio,tipoProcessoPrevidenciaSocial,extensaoDecisaoPrevidenciaSocial,numeroProcessoPrevidenciaSocial,indicativoSuspensaoPrevidenciaSocial,numeroProcessoFgts,
numeroProcessoContribuicaoSindicalLaboral,numeroProcessoIrrf,indicativoSuspensaoIrrf,tabelarubrica, descricaoRubrica, descricaoRubricaFeriasMes, incidenciaPrevidenciaSocialFeriasMes, tipoProcessoPrevidenciaSocialFeriasMes,
numeroProcessoPrevidenciaSocialFeriasMes, extensaoDecisaoPrevidenciaSocialFeriasMes, indicativoSuspensaoPrevidenciaSocialFeriasMes, incidenciaIrrfFeriasMes, numeroProcessoIrrfFeriasMes, indicativoSuspensaoIrrfFeriasMes,
incidenciaFgtsFeriasMes, numeroProcessoFgtsFeriasMes, incidenciaContribuicaoSindicalLaboralFeriasMes, incidenciaRppsFeriasMes, numeroProcessoContribuicaoSindicalLaboralFeriasMes, codigoRubrica, codigoRubricaFeriasMes
        
            from (select 300 as sistema, 
                         'configuracao-evento' as tipo_registro, 
                         i_eventos,   
                         nomeOriginal = e.nome , 
                         historicos = null,
                           inicioVigenciaataual = '1990-01',
                         nome + ' (' + if padrao = 1 then 'PADRAO' else 'NAO_PADRAO' endif + ') (REVISAR)' as nomeEvento,
                         padrao = isnull((select formulas_padroes.padrao_migracao
                                            from bethadba.eventos, 
                                                 bethadba.formulas_calc,
                                                 bethadba.formulas_padroes 
                                           where eventos.i_eventos = e.i_eventos 
                                             and eventos.i_eventos = formulas_calc.i_eventos 
                                             and eventos.nome = formulas_padroes.nome 
                                             and formulas_padroes.tipo = 1 
                                             and trim(formulas_padroes.texto) = trim(formulas_calc.descricao)),0), 
                         tipo = if tipo_pd = 'P' and compoe_liq = 'S' then 'VENCIMENTO' else 
                                if tipo_pd = 'D' and compoe_liq = 'S' then 'DESCONTO' else 
                                if tipo_pd = 'P' and compoe_liq = 'N' then 'INFORMATIVO_MAIS' else 
                                if tipo_pd = 'D' and compoe_liq = 'N' then 'INFORMATIVO_MENOS' endif endif endif endif,
                         incidenciaProcessamentoFeriasQtd = (select count(distinct(codigo_esocial)) as quantidade
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos),                                                                                         
                         incidenciaProcessamentoFerias = if (select first eh.rubrica_esocial
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                             and eh.i_competencia_inicio = (select min(eh1.i_competencia_inicio) 
                                                                                              from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                            where eh.i_eventos = eh1.i_eventos)) in ('1016', '1017', '1018', '1019' , '1020' , '1021', '1022', '1023', '1024') and incidenciaProcessamentoFeriasQtd > 1 then 'true' else 'false' endif,             
                         
                         naturezaRubricaAux = isnull((select first eh.rubrica_esocial 
                                                        from bethadba.eventos_hist_agrup_esocial eh 
                                                       where eh.i_eventos = e.i_eventos
                                                         and eh.i_competencia_inicio = (select min(eh1.i_competencia_inicio) 
                                                                                          from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                         where eh.i_eventos = eh1.i_eventos) 
                                                                                         order by eh.i_competencia_inicio asc),null),
                            tabelarubrica = if incidenciaProcessamentoFerias = 'false' then  
                                                        (select first eh.tabela_rubrica 
                                                        from bethadba.eventos_hist_agrup_esocial eh 
                                                       where eh.i_eventos = e.i_eventos
                                                         and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                          from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                         where eh.i_eventos = eh1.i_eventos) 
                                                                                         order by eh.i_competencia_inicio desc)
                                                       else (select first eh.tabela_rubrica 
                                                        from bethadba.eventos_hist_agrup_esocial eh 
                                                       where eh.i_eventos = e.i_eventos
                                                         and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
                         incidenciaPrevidenciaSocialAux =  if incidenciaProcessamentoFerias = 'false' then 
                                                         (select first eh.incidencia_previdencia
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                             and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                              from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                            where eh.i_eventos = eh1.i_eventos) 
                                                                                            order by eh.i_competencia_inicio desc)
                                                        else (select first eh.incidencia_previdencia
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                              and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,                                                                              
                         incidenciaPrevidenciaSocial = case incidenciaPrevidenciaSocialAux
                                                          when '00' then 'NAO_E_BASE_DE_CALCULO'
                                                          when '01' then 'NAO_E_BASE_DE_CALCULO_EM_FUNCAO_DE_ACORDOS_INTERNACIONAIS_DE_PREVIDENCIA_SOCIAL'
                                                          when '11' then 'SALARIO_CONTRIBUICAO_MENSAL'
                                                          when '12' then 'SALARIO_CONTRIBUICAO_DECIMO_TERCEIRO_SALARIO'
                                                          when '13' then 'SALARIO_CONTRIBUICAO_EXCLUSIVA_DO_EMPREGADOR_MENSAL'
                                                          when '14' then 'SALARIO_CONTRIBUICAO_EXCLUSIVA_DO_EMPREGADOR_DECIMO_TERCEIRO_SALARIO'
                                                          when '15' then 'EXCLUSIVA_DO_SEGURADO_MENSAL'
                                                          when '16' then 'EXCLUSIVA_DO_SEGURADO_DECIMO_TERCEIRO_SALARIO'
                                                          when '21' then 'SALARIO_MATERNIDADE_MENSAL_PAGO_PELO_EMPREGADOR'
                                                          when '22' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO_PAGO_PELO_EMPREGADOR'
                                                          when '23' then 'AUXILIO_DOENCA_MENSAL_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '24' then 'AUXILIO_DOENCA_DECIMO_TERCEIRO_SALARIO_DOENCA_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '25' then 'SALARIO_MATERNIDADE_MENSAL_PAGO_PELO_INSS'
                                                          when '26' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO_PAGO_PELO_INSS'
                                                          when '31' then 'CONTRIBUICAO_DESCONTADA_SALARIO_CONTRIBUICAO_MENSAL'
                                                          when '32' then 'CONTRIBUICAO_DESCONTADA_SALARIO_CONTRIBUICAO_DECIMO_TERCEIRO_SALARIO'
                                                          when '34' then 'SEST'
                                                          when '35' then 'SENAT'
                                                          when '51' then 'SALARIO_FAMILIA'
                                                          when '61' then 'COMPLEMENTO_DE_SALARIO_MINIMO_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '91' then 'SUSPENCAO_INCIDENCIA_MENSAL'
                                                          when '92' then 'SUSPENCAO_INCIDENCIA_DECIMO_TERCEIRO_SALARIO'
                                                          when '93' then 'SALARIO_MATERNIDADE'
                                                          when '94' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO'
                                                          when '95' then 'SUSPENCAO_INCIDENCIA_EXCLUSIVA_DO_EMPREGADOR_MENSAL'
                                                          when '96' then 'SUSPENCAO_INCIDENCIA_EXCLUSIVA_DO_EMPREGADOR_DECIMO_TERCEIRO_SALARIO'
                                                          when '97' then 'EXCLUSIVA_DO_EMPREGADOR_SALARIO_MATERNIDADE'
                                                          when '98' then 'EXCLUSIVA_DO_EMPREGADOR_SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO'
                                                       else
                                                          null
                                                       end,
                         incidenciaIrrfAux = if incidenciaProcessamentoFerias = 'false' then 
                                                 (select first eh.incidencia_irrf
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                 from bethadba.eventos_hist_agrup_esocial eh1 
                                                                               where eh.i_eventos = eh1.i_eventos) 
                                                                               order by eh.i_competencia_inicio desc)
                                              else (select first eh.incidencia_irrf
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
                         incidenciaIrrf = case incidenciaIrrfAux
                                             when '00'   then 'RENDIMENTO_NAO_TRIBUTAVEL'
                                             when '01'   then 'RENDIMENTO_NAO_TRIBUTAVEL_EM_FUNCAO_DE_ACORDOS_INTERNACIONAIS_DE_BITRIBUTACAO'
                                             when '09'   then 'OUTRAS_VERBAS_NAO_CONSIDERADAS_COMO_BASE_DE_CALCULO_OU_RENDIMENTO'
                                             when '11'   then 'RENDIMENTOS_TRIBUTAVEL_REMUNERACAO_MENSAL'
                                             when '12'   then 'DECIMO_TERCEIRO_SALARIO_DECIMO_TERCEIRO'
                                             when '13'   then 'DECIMO_TERCEIRO_SALARIO_FERIAS'
                                             when '14'   then 'RENDIMENTOS_TRIBUTAVEL_PLR'
                                             when '15'   then 'RENDIMENTOS_RECEBIDOS_ACUMULADAMENTE_RRA'
                                             when '31'   then 'RETENCAO_IRRF_REMUNERACAO_MENSAL'
                                             when '32'   then 'RETENCAO_IRRF_DECIMO_TERCEIRO_SALARIO'
                                             when '33'   then 'RETENCAO_IRRF_FERIAS'
                                             when '34'   then 'RETENCAO_IRRF_PLR'
                                             when '35'   then 'RETENCAO_IRRF_RRA'
                                             when '41'   then 'PREVIDENCIA_SOCIAL_OFICIAL_PSO_REMUNER_MENSAL'
                                             when '42'   then 'PSO_DECIMO_TERCEIRO_SALARIO'
                                             when '43'   then 'PSO_FERIAS'
                                             when '44'   then 'PSO_RRA'
                                             when '46'   then 'PREVIDENCIA_PRIVADA_SALARIO_MENSAL'
                                             when '47'   then 'PREVIDENCIA_PRIVADA_DECIMO_TERCEIRO_SALARIO'
                                             when '51'   then 'PENSAO_ALIMENTICIA_REMUNERACAO_MENSAL'
                                             when '52'   then 'PENSAO_ALIMENTICIA_DECIMO_TERCEIRO_SALARIO'
                                             when '53'   then 'PENSAO_ALIMENTICIA_FERIAS'
                                             when '54'   then 'PENSAO_ALIMENTICIA_PLR'
                                             when '55'   then 'PENSAO_ALIMENTICIA_RRA'
                                             when '61'   then 'FUNDO_DE_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_REMUNERACAO_MENSAL'
                                             when '62'   then 'FUNDO_DE_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_DECIMO_TERCEIRO_SALARIO'
                                             when '63'   then 'FUNDACAO_DE_PREVIDENCIA_COMPLEMENTAR_DO_SERVIDOR_PUBLICO_FUNPRESP_REMUNERACAO_MENSAL'
                                             when '64'   then 'FUNDACAO_DE_PREVIDENCIA_COMPLEMENTAR_DO_SERVIDOR_PUBLICO_FUNPRESP_DECIMO_TERCEIRO_SALARIO'
                                             when '70'   then 'PARCELA_ISENTA_SESSENTA_CINCO_ANOS_REMUNERACAO_MENSAL'
                                             when '71'   then 'PARCELA_ISENTA_SESSENTA_CINCO_ANOS_DECIMO_TERCEIRO_SALARIO'
                                             when '72'   then 'DIARIAS'
                                             when '73'   then 'AJUDA_DE_CUSTO'
                                             when '74'   then 'INDENIZACAO_E_RESCISAO_DE_CONTRATO_INCLUSIVE_A_TITULO_DE_PDV_E_ACIDENTES_DE_TRABALHO'
                                             when '75'   then 'ABONO_PECUNIARIO'
                                             when '76'   then 'PENSAO_APOSENTADORIA_OU_REFORMA_POR_MOLESTIA_GRAVE_OU_ACIDENTE_EM_SERVICO_REMUNERACAO_MENSAL'
                                             when '77'   then 'PENSAO_APOSENTADORIA_OU_REFORMA_POR_MOLESTIA_GRAVE_OU_ACIDENTE_EM_SERVICO_DECIMO_TERCEIRO_SALARIO'
                                             when '78'   then 'VALORES_PAGOS_A_TITULAR_OU_SOCIO_DE_MICROEMPRESA_OU_EMPRESA_DE_PEQUENO_PORTE_EXCETO_PRO_LABORE_E_ALUGUEIS'
                                             when '79'   then 'OUTRAS_ISENCOES_O_NOME_DA_RUBRICA_DEVE_SER_CLARO_PARA_IDENTIFICACAO_DA_NATUREZA_DOS_VALORES'
                                             when '81'   then 'DEPOSITO_JUDICIAL'
                                             when '9082' then 'COMPENSACAO_JUDICIAL_DO_ANO_CALENDARIO'
                                             when '9083' then 'COMPENSACAO_JUDICIAL_DE_ANOS_ANTERIORES'
                                             when '91'   then 'REMUNERACAO_MENSAL'
                                             when '92'   then 'DECIMO_TERCEIRO_SALARIO'
                                             when '93'   then 'FERIAS'
                                             when '94'   then 'PLR'
                                             when '95'   then 'RRA'
                                             when '65'   then 'FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO'
                                             when '66'   then 'FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL'
                                             when '67'   then 'PLANO_PRIVADO_COLETIVO_ASSISTENCIA_SAUDE'
                                             when '700'  then 'AUXILIO_MORADIA'
                                             when '701'  then 'PARTE_TRIBUTAVEL_VALOR_SERVICO_TRANSPORTE_PASSAGEIROS_CARGAS'
                                             when '9011' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_REMUNERACAO_MENSAL'
                                             when '9012' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_DECIMO_TECEIRO_SALARIO'
                                             when '9013' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_FERIAS'
                                             when '9014' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_PLR'
                                             when '9031' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_REMUNERACAO_MENSAL'
                                             when '9032' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DECIMO_TERCEIRO_SALARIO'
                                             when '9033' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_FERIAS'
                                             when '9034' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_PLR'
                                             when '9831' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_MENSAL'
                                             when '9832' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_DECIMO_TERCEIRO_SALARIO'
                                             when '9833' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_FERIAS'
                                             when '9834' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_PLR'
                                             when '9041' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_SOCIAL_OFICIAL_PSO_REMUNERACAO_MENSAL'
                                             when '9042' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PSO_DECIMO_TERCEIRO_SALARIO'
                                             when '9043' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PSO_FERIAS'
                                             when '9046' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_SALARIO_MENSAL'
                                             when '9047' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_DECIMO_TERCEIRO_SALARIO'
                                             when '9048' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_FERIAS'
                                             when '9051' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_REMUNERACAO_MENSAL'
                                             when '9052' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_DECIMO_TERCEIRO_SALARIO'
                                             when '9053' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_FERIAS'
                                             when '9054' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_PLR'
                                             when '9061' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_REMUNERACAO_MENSAL'
                                             when '9062' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_DECIMO_TERCEIRO_SALARIO'
                                             when '9063' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_REMUNERACAO_MENSAL'
                                             when '9064' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_DECIMO_TERCEIRO_SALARIO'
                                             when '9065' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_FERIAS'
                                             when '9066' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_FERIAS'
                                             when '9067' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PLANO_PRIVADO_COLETIVO_ASSISTENCIA_SAUDE'
                                          else
                                             null
                                          end,
                         incidenciaFgtsAux =  if incidenciaProcessamentoFerias = 'false' then 
                                                 (select first eh.incidencia_fgts
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                 from bethadba.eventos_hist_agrup_esocial eh1 
                                                                               where eh.i_eventos = eh1.i_eventos) 
                                                                               order by eh.i_competencia_inicio desc)
                                            else (select first eh.incidencia_fgts
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
                         incidenciaFgts = case incidenciaFgtsAux
                                             when '00' then 'NAO_E_BASE_DE_CALCULO_DO_FGTS'
                                             when '11' then 'BASE_DE_CALCULO_DO_FGTS'
                                             when '12' then 'BASE_DE_CALCULO_DO_FGTS_DECIMO_TERCEIRO_SALARIO'
                                             when '21' then 'BASE_DE_CALCULO_DO_FGTS_RESCISORIO_AVISO_PREVIO'
                                             when '91' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                             when '92' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_FGTS_DECIMO_TERCEIRO_SALARIO'
                                             when '93' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_FGTS_AVISO_PREVIO_IDENIZADO'
                                          else
                                             null
                                          end,
                         incidenciaContribuicaoSindicalLaboralAux =   if incidenciaProcessamentoFerias = 'false' then 
                                                                         (select first eh.incidencia_contrato_sindical
                                                                       from bethadba.eventos_hist_agrup_esocial eh 
                                                                     where eh.i_eventos = e.i_eventos
                                                                       and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                                        from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                                      where eh.i_eventos = eh1.i_eventos) 
                                                                                                      order by eh.i_competencia_inicio desc)
                                                                    else  (select first eh.incidencia_contrato_sindical
                                                                       from bethadba.eventos_hist_agrup_esocial eh 
                                                                     where eh.i_eventos = e.i_eventos
                                                                      and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
                         incidenciaContribuicaoSindicalLaboral = case incidenciaContribuicaoSindicalLaboralAux
                                                                    when '00' then 'NAO_E_BASE_DE_CALCULO'
                                                                    when '11' then 'BASE_DE_CALCULO'
                                                                    when '31' then 'VALOR_DA_CONTRIBUICAO_SINDICAL_LABORAL_DESCONTADA'
                                                                    when '91' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                                                 else
                                                                    null
                                                                 end,
                         incidenciaRppsAux =  if incidenciaProcessamentoFerias = 'false' then
                                                 (select first eh.incidencia_rpps
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                 from bethadba.eventos_hist_agrup_esocial eh1 
                                                                               where eh.i_eventos = eh1.i_eventos) 
                                                                               order by eh.i_competencia_inicio desc)
                                              else  (select first eh.incidencia_rpps
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
                         incidenciaRpps = case incidenciaRppsAux
                                             when '00' then 'NAO_E_BASE_DE_CALCULO_DE_CONTRIBUICOES_DEVIDAS_AO_RPPS_REGIME_MILITAR'
                                             when '11' then 'BASE_DE_CALCULO_DE_CONTRIBUICOES_DIVIDAS_AO_RPPS_REGIME_MILITAR'
                                             when '12' then 'BASE_DE_CALCULO_DE_CONTRIBUICOES_DEVIDAS_AO_RPPS_REGIME_MILITAR_DECIMO_TERCEIRO_SALARIO'
                                             when '31' then 'CONTRIBUICAO_DESCONTADA_DO_SEGURADO_E_BENEFICIARIO'
                                             when '32' then 'CONTRIBUICAO_DESCONTADA_DO_SEGURADO_E_BENEFICIARIO_DECIMO_TERCEIRO_SALARIO'
                                             when '91' then 'SUSPENSAO_DE_INCIDENCIA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                             when '92' then 'SUSPENSAO_DE_INCIDENCIA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_13_SALARIO'
                                          else
                                             null
                                          end,
                         naturezaRubrica = bethadba.dbf_GetEsocial_NaturezaRubrica(naturezaRubricaAux,2),
                         classificacao_evento = case classif_evento
                                                   when 0 then 'NENHUMA'
                                                   when 1 then 'AUXNAT'
                                                   when 2 then 'FGTS'
                                                   when 3 then 'FGTS13SAL'
                                                   when 4 then 'FGTSMESANT'
                                                   when 5 then 'IRRF'
                                                   when 6 then 'IRRF13SAL'
                                                   when 7 then 'IRRFFERIASRESC'
                                                   when 8 then 'INSS'
                                                   when 9 then 'INSS13SAL'
                                                   when 10 then 'PREVEST'
                                                   when 11 then 'PREVESTDECSAL'
                                                   when 12 then 'FUNDASS'
                                                   when 13 then 'FUNDASS13SAL'
                                                   when 14 then 'FUNDPREV'
                                                   when 15 then 'FUNDPREV13SAL'
                                                   when 16 then 'SALFAMCEL'
                                                   when 17 then 'SALFAMEST'
                                                   when 18 then 'SALFAMAPOS'
                                                   when 19 then 'SALFAMESP'
                                                   when 20 then 'SALFAMPAGMAIOR'
                                                   when 21 then 'INTEG13SAL'
                                                   when 22 then 'ADI13SAL'
                                                   when 23 then 'DESC13SALADI'
                                                   when 24 then 'DESCHAUXMAT'
                                                   when 25 then 'DESCHAUXMAT13SAL'
                                                   when 26 then 'AVPREIND'
                                                   when 27 then 'AVPREINDUMDOZE'
                                                   when 28 then 'FGTSAVPRE'
                                                   when 29 then 'MULTAFGTS'
                                                   when 30 then 'ABATSALM'
                                                   when 31 then 'DESCDEP'
                                                   when 32 then 'FALTAS'
                                                   when 33 then 'BASINSSDV'
                                                   when 34 then 'BASINSSDV13SAL'
                                                   when 35 then 'BASIRRFDV'
                                                   when 36 then 'BASIRRFDV13SAL'
                                                   when 37 then 'BASIRRFFERIASRESCDV'
                                                   when 38 then 'PARCISENIRRF'
                                                   when 39 then 'PARCISENIRRF13SAL'
                                                   when 40 then 'PARCISENIRRFSOBFERIASRESC'
                                                   when 41 then 'HAUXMATNPAG'
                                                   when 42 then 'INSSSOBHAUXMATNPAG'
                                                   when 43 then 'ABATSALM13'
                                                   when 44 then 'PARCISENFUNDPREV'
                                                   when 45 then 'PARCISENFUNDPREV13SAL'
                                                   when 46 then 'BASINSSOUTEMP'
                                                   when 47 then 'BASINSSOUTEMP13SAL'
                                                   when 48 then 'BASIRRFOUTEMP'
                                                   when 49 then 'BASIRRFOUTEMP13SAL'
                                                   when 50 then 'REDBASINSSTRANSPAUT'
                                                   when 51 then 'REDBASIRRFTRANSPAUT'
                                                   when 52 then 'BASIRRFFERIASANT'
                                                   when 53 then 'PROCEDMED'
                                                   when 54 then 'PARCISENIRRFMOLGRV'
                                                   when 55 then 'PARCISENIRRFMOLGRV13SAL'
                                                   when 56 then 'PARCISENIRRFMOLGRVFERIASRESC'
                                                   when 57 then 'BASABATINSSDV'
                                                   when 58 then 'PARCISENIRRFMOLGRVFERIAS'
                                                   when 59 then 'PRORROGAUXMAT11770'
                                                   when 60 then 'ADIFERIAS'
                                                   when 61 then 'DEVIRRF'
                                                   when 62 then 'DEVINSS'
                                                   when 63 then 'AVPREDESC'
                                                   when 64 then 'AVPREIND13SAL'
                                                   when 65 then 'VALETRANSP'
                                                   when 66 then 'EMPRESTIMO'
                                                   when 67 then 'PARCISENIRRFMOLGRVFERIASADI'
                                                   when 68 then 'PLANOSAUDE'
                                                   when 69 then 'SEST'
                                                   when 70 then 'SENAT'
                                                   when 71 then 'FALTADSR'
                                                   when 72 then 'ADISALNDESC'
                                                   when 73 then 'DESCADISAL'
                                                   when 74 then 'DESC13SALDEVREINTG'
                                                   when 75 then 'RPPSABAT'
                                                   when 76 then 'RPPSABAT13'
                                                   when 77 then 'FUNDFIN'
                                                   when 78 then 'FUNDFIN13SAL'
                                                   when 79 then 'PARCISENFUNDFIN'
                                                   when 80 then 'PARCISENFUNDFIN13SAL'
                                                   when 81 then 'DEVFGTS'
                                                   when 82 then 'ISS'
                                                   when 83 then 'PONTIDAO'
                                                   when 84 then 'SOBREAVISO'
                                                   when 85 then 'PENSJUDDESC'
                                                   when 86 then 'FERIASTERCO'
                                                   when 87 then 'FERVENCTERCO'
                                                   when 88 then 'FERPROPTERCO'
                                                   when 89 then 'ABONOTERCO'
                                                   when 90 then 'BASEINSSNEG'
                                                   when 91 then 'FERINDENTERCO'
                                                   when 92 then 'FERDOBROTERCO'
                                                   else null
                                                end,
                         classificacaoBaixaProvisao = case classif_provisao 
                                                     when 1  then 'DECIMO_TERCEIRO_SALARIO'
                                                     when 2  then 'MEDIA_VANTAGEM_DECIMO_TERCEIRO_SALARIO'
                                                     when 3  then 'FERIAS'
                                                     when 4  then 'MEDIA_VANTAGEM_FERIAS'
                                                     when 5  then 'UM_TERCO_FERIAS'
                                                     when 6  then 'FGTS_DECIMO_TERCEIRO_SALARIO'
                                                     when 7  then 'FGTS_FERIAS'
                                                     when 8  then 'FERIAS_ABONO_RESCISAO'
                                                     when 9  then 'MEDIA_VANTAGEM_FERIAS_ABONO_RESCISAO'
                                                     when 10 then 'UM_TERCO_FERIAS_ABONO_RESCISAO' 
                                                     else null 
                                                  end,
                         unidade = case unidade 
                                      when 'Horas' then 'HORAS'
                                      when 'Percentual' then 'PERCENTUAL'
                                      when 'Valor' then 'VALOR'
                                      when 'Dias' then 'DIAS' 
                                      else 'AUTOMATICO'   
                                   end,
                         taxa, 
                         bethadba.dbf_get_id_gerado(300, 'ato', isnull(i_atos, 0)) as ato, 
                         compoe_hmes = if compoe_hmes = 'S' then 'true' else 'false' endif, 
                         desativado = if desativado = 'S' then 'true' else 'false' endif, 
                         e.descricao, 
                         enviar_esocial = if enviar_esocial = 'S' then 'true' else 'false' endif,
                         enviaRais = if sai_rais = 'S' then 'true' else 'false' endif,
                         envia_fly = if envia_fly_transparencia = 'S' then 'true' else 'false' endif,
                         deduz_prev = isnull((select deduz_prev from bethadba.cond_eventos where cond_eventos.i_eventos = e.i_eventos),'N'),
                         tiposPrevidencia = (if isnull(deduc_prevmun,'N') = 'S' then 'FUNDO_PREVIDENCIA,' endif)||
                                            (if isnull(deduc_fundo_financ,'N') = 'S' then 'FUNDO_FINANCEIRO,' endif)||
                                            (if deduz_prev = 'S' then 'FEDERAL,' endif),
                        codigoEsocial = (select first eh.codigo_esocial
                                            from bethadba.eventos_hist_agrup_esocial eh 
                                          where eh.i_eventos = e.i_eventos
                                            and eh.i_competencia_inicio = (select min(eh1.i_competencia_inicio) 
                                                                             from bethadba.eventos_hist_agrup_esocial eh1 
                                                                           where eh.i_eventos = eh1.i_eventos) 
                                                                           order by eh.i_competencia_inicio asc),
                         tetoRemuneratorioAux = (select first eh.teto_remuneratorio
                                                   from bethadba.eventos_hist_agrup_esocial eh 
                                                 where eh.i_eventos = e.i_eventos
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc),
                         tetoRemuneratorio = if tetoRemuneratorioAux = 'S' then 'true' else 'false' endif,
                         
tipoProcessoPrevidenciaSocialaux = if incidenciaProcessamentoFerias = 'false' then 
                                                    (select first eh.tipo_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                               else (select first eh.tipo_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
tipoProcessoPrevidenciaSocial = case tipoProcessoPrevidenciaSocialaux 
                                      when 1 then 'ADMINISTRATIVO' 
                                      when 2 then 'JUDICIAL' 
                                      else null   
                                   end,

extensaoDecisaoPrevidenciaSocialaux = if incidenciaProcessamentoFerias = 'false' then 
                                                (select first eh.extensao_decisao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                                 else (select first eh.extensao_decisao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
extensaoDecisaoPrevidenciaSocial = case extensaoDecisaoPrevidenciaSocialaux 
                                      when 1 then 'CONTRIBUICAO_PREVIDENCIARIA_PATRONAL' 
                                      when 2 then 'CONTRIBUICAO_PREVIDENCIARIA_PATRONAL_DESCONTADA_SEGURADOS' 
                                      else null   
                                   end,
numeroProcessoPrevidenciaSocial=  if incidenciaProcessamentoFerias = 'false' then 
                                                    (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                                   else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
indicativoSuspensaoPrevidenciaSocial = if incidenciaProcessamentoFerias = 'false' then 
                                                (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                               else (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
numeroProcessoFgts = if incidenciaProcessamentoFerias = 'false' then 
                                                (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'FGT'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                                else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'FGT'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
numeroProcessoContribuicaoSindicalLaboral = if incidenciaProcessamentoFerias = 'false' then  
                                                (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'CTS'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                               else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'CTS'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
numeroProcessoIrrf = if incidenciaProcessamentoFerias = 'false' then
                                                (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                                else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
indicativoSuspensaoIrrf =  if incidenciaProcessamentoFerias = 'false' then 
                                                (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and eh.i_competencia_inicio = (select max(eh1.i_competencia_inicio) 
                                                                                    from bethadba.eventos_hist_agrup_esocial eh1 
                                                                                  where eh.i_eventos = eh1.i_eventos) 
                                                                                  order by eh.i_competencia_inicio desc)
                                                else (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,                                  
descricaoRubrica =   if incidenciaProcessamentoFerias = 'false' then null else (select first eh.nome_esocial
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                             and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.1') endif,
 descricaoRubricaFeriasMes = if incidenciaProcessamentoFerias = 'false' then null else (select first eh.nome_esocial
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                             and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaPrevidenciaSocialFeriasMesAx =  if incidenciaProcessamentoFerias = 'false' then null else (select first eh.incidencia_previdencia
                                                             from bethadba.eventos_hist_agrup_esocial eh 
                                                           where eh.i_eventos = e.i_eventos
                                                             and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,    
incidenciaPrevidenciaSocialFeriasMes = case incidenciaPrevidenciaSocialFeriasMesAx
                                                          when '00' then 'NAO_E_BASE_DE_CALCULO'
                                                          when '01' then 'NAO_E_BASE_DE_CALCULO_EM_FUNCAO_DE_ACORDOS_INTERNACIONAIS_DE_PREVIDENCIA_SOCIAL'
                                                          when '11' then 'SALARIO_CONTRIBUICAO_MENSAL'
                                                          when '12' then 'SALARIO_CONTRIBUICAO_DECIMO_TERCEIRO_SALARIO'
                                                          when '13' then 'SALARIO_CONTRIBUICAO_EXCLUSIVA_DO_EMPREGADOR_MENSAL'
                                                          when '14' then 'SALARIO_CONTRIBUICAO_EXCLUSIVA_DO_EMPREGADOR_DECIMO_TERCEIRO_SALARIO'
                                                          when '15' then 'EXCLUSIVA_DO_SEGURADO_MENSAL'
                                                          when '16' then 'EXCLUSIVA_DO_SEGURADO_DECIMO_TERCEIRO_SALARIO'
                                                          when '21' then 'SALARIO_MATERNIDADE_MENSAL_PAGO_PELO_EMPREGADOR'
                                                          when '22' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO_PAGO_PELO_EMPREGADOR'
                                                          when '23' then 'AUXILIO_DOENCA_MENSAL_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '24' then 'AUXILIO_DOENCA_DECIMO_TERCEIRO_SALARIO_DOENCA_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '25' then 'SALARIO_MATERNIDADE_MENSAL_PAGO_PELO_INSS'
                                                          when '26' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO_PAGO_PELO_INSS'
                                                          when '31' then 'CONTRIBUICAO_DESCONTADA_SALARIO_CONTRIBUICAO_MENSAL'
                                                          when '32' then 'CONTRIBUICAO_DESCONTADA_SALARIO_CONTRIBUICAO_DECIMO_TERCEIRO_SALARIO'
                                                          when '34' then 'SEST'
                                                          when '35' then 'SENAT'
                                                          when '51' then 'SALARIO_FAMILIA'
                                                          when '61' then 'COMPLEMENTO_DE_SALARIO_MINIMO_REGIME_PROPRIO_DE_PREVIDENCIA_SOCIAL'
                                                          when '91' then 'SUSPENCAO_INCIDENCIA_MENSAL'
                                                          when '92' then 'SUSPENCAO_INCIDENCIA_DECIMO_TERCEIRO_SALARIO'
                                                          when '93' then 'SALARIO_MATERNIDADE'
                                                          when '94' then 'SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO'
                                                          when '95' then 'SUSPENCAO_INCIDENCIA_EXCLUSIVA_DO_EMPREGADOR_MENSAL'
                                                          when '96' then 'SUSPENCAO_INCIDENCIA_EXCLUSIVA_DO_EMPREGADOR_DECIMO_TERCEIRO_SALARIO'
                                                          when '97' then 'EXCLUSIVA_DO_EMPREGADOR_SALARIO_MATERNIDADE'
                                                          when '98' then 'EXCLUSIVA_DO_EMPREGADOR_SALARIO_MATERNIDADE_DECIMO_TERCEIRO_SALARIO'
                                                       else
                                                          null
                                                       end,
tipoProcessoPrevidenciaSocialFeriasMesaux = if incidenciaProcessamentoFerias = 'false' then null
                                               else (select first eh.tipo_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
tipoProcessoPrevidenciaSocialFeriasMes = case tipoProcessoPrevidenciaSocialFeriasMesaux 
                                      when 1 then 'ADMINISTRATIVO' 
                                      when 2 then 'JUDICIAL' 
                                      else null   
                                   end,
numeroProcessoPrevidenciaSocialFeriasMes =  if incidenciaProcessamentoFerias = 'false' then null
                                                   else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
extensaoDecisaoPrevidenciaSocialFeriasMesaux = if incidenciaProcessamentoFerias = 'false' then null
                                                 else (select first eh.extensao_decisao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
extensaoDecisaoPrevidenciaSocialFeriasMes = case extensaoDecisaoPrevidenciaSocialFeriasMesaux 
                                      when 1 then 'CONTRIBUICAO_PREVIDENCIARIA_PATRONAL' 
                                      when 2 then 'CONTRIBUICAO_PREVIDENCIARIA_PATRONAL_DESCONTADA_SEGURADOS' 
                                      else null   
                                   end,
indicativoSuspensaoPrevidenciaSocialFeriasMes = if incidenciaProcessamentoFerias = 'false' then null
                                               else (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'PVD'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,  
incidenciaIrrfFeriasMesAux = if incidenciaProcessamentoFerias = 'false' then null
                                              else (select first eh.incidencia_irrf
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaIrrfFeriasMes = case incidenciaIrrfFeriasMesAux
                                             when '00'   then 'RENDIMENTO_NAO_TRIBUTAVEL'
                                             when '01'   then 'RENDIMENTO_NAO_TRIBUTAVEL_EM_FUNCAO_DE_ACORDOS_INTERNACIONAIS_DE_BITRIBUTACAO'
                                             when '09'   then 'OUTRAS_VERBAS_NAO_CONSIDERADAS_COMO_BASE_DE_CALCULO_OU_RENDIMENTO'
                                             when '11'   then 'RENDIMENTOS_TRIBUTAVEL_REMUNERACAO_MENSAL'
                                             when '12'   then 'DECIMO_TERCEIRO_SALARIO_DECIMO_TERCEIRO'
                                             when '13'   then 'DECIMO_TERCEIRO_SALARIO_FERIAS'
                                             when '14'   then 'RENDIMENTOS_TRIBUTAVEL_PLR'
                                             when '15'   then 'RENDIMENTOS_RECEBIDOS_ACUMULADAMENTE_RRA'
                                             when '31'   then 'RETENCAO_IRRF_REMUNERACAO_MENSAL'
                                             when '32'   then 'RETENCAO_IRRF_DECIMO_TERCEIRO_SALARIO'
                                             when '33'   then 'RETENCAO_IRRF_FERIAS'
                                             when '34'   then 'RETENCAO_IRRF_PLR'
                                             when '35'   then 'RETENCAO_IRRF_RRA'
                                             when '41'   then 'PREVIDENCIA_SOCIAL_OFICIAL_PSO_REMUNER_MENSAL'
                                             when '42'   then 'PSO_DECIMO_TERCEIRO_SALARIO'
                                             when '43'   then 'PSO_FERIAS'
                                             when '44'   then 'PSO_RRA'
                                             when '46'   then 'PREVIDENCIA_PRIVADA_SALARIO_MENSAL'
                                             when '47'   then 'PREVIDENCIA_PRIVADA_DECIMO_TERCEIRO_SALARIO'
                                             when '51'   then 'PENSAO_ALIMENTICIA_REMUNERACAO_MENSAL'
                                             when '52'   then 'PENSAO_ALIMENTICIA_DECIMO_TERCEIRO_SALARIO'
                                             when '53'   then 'PENSAO_ALIMENTICIA_FERIAS'
                                             when '54'   then 'PENSAO_ALIMENTICIA_PLR'
                                             when '55'   then 'PENSAO_ALIMENTICIA_RRA'
                                             when '61'   then 'FUNDO_DE_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_REMUNERACAO_MENSAL'
                                             when '62'   then 'FUNDO_DE_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_DECIMO_TERCEIRO_SALARIO'
                                             when '63'   then 'FUNDACAO_DE_PREVIDENCIA_COMPLEMENTAR_DO_SERVIDOR_PUBLICO_FUNPRESP_REMUNERACAO_MENSAL'
                                             when '64'   then 'FUNDACAO_DE_PREVIDENCIA_COMPLEMENTAR_DO_SERVIDOR_PUBLICO_FUNPRESP_DECIMO_TERCEIRO_SALARIO'
                                             when '70'   then 'PARCELA_ISENTA_SESSENTA_CINCO_ANOS_REMUNERACAO_MENSAL'
                                             when '71'   then 'PARCELA_ISENTA_SESSENTA_CINCO_ANOS_DECIMO_TERCEIRO_SALARIO'
                                             when '72'   then 'DIARIAS'
                                             when '73'   then 'AJUDA_DE_CUSTO'
                                             when '74'   then 'INDENIZACAO_E_RESCISAO_DE_CONTRATO_INCLUSIVE_A_TITULO_DE_PDV_E_ACIDENTES_DE_TRABALHO'
                                             when '75'   then 'ABONO_PECUNIARIO'
                                             when '76'   then 'PENSAO_APOSENTADORIA_OU_REFORMA_POR_MOLESTIA_GRAVE_OU_ACIDENTE_EM_SERVICO_REMUNERACAO_MENSAL'
                                             when '77'   then 'PENSAO_APOSENTADORIA_OU_REFORMA_POR_MOLESTIA_GRAVE_OU_ACIDENTE_EM_SERVICO_DECIMO_TERCEIRO_SALARIO'
                                             when '78'   then 'VALORES_PAGOS_A_TITULAR_OU_SOCIO_DE_MICROEMPRESA_OU_EMPRESA_DE_PEQUENO_PORTE_EXCETO_PRO_LABORE_E_ALUGUEIS'
                                             when '79'   then 'OUTRAS_ISENCOES_O_NOME_DA_RUBRICA_DEVE_SER_CLARO_PARA_IDENTIFICACAO_DA_NATUREZA_DOS_VALORES'
                                             when '81'   then 'DEPOSITO_JUDICIAL'
                                             when '9082' then 'COMPENSACAO_JUDICIAL_DO_ANO_CALENDARIO'
                                             when '9083' then 'COMPENSACAO_JUDICIAL_DE_ANOS_ANTERIORES'
                                             when '91'   then 'REMUNERACAO_MENSAL'
                                             when '92'   then 'DECIMO_TERCEIRO_SALARIO'
                                             when '93'   then 'FERIAS'
                                             when '94'   then 'PLR'
                                             when '95'   then 'RRA'
                                             when '65'   then 'FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO'
                                             when '66'   then 'FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL'
                                             when '67'   then 'PLANO_PRIVADO_COLETIVO_ASSISTENCIA_SAUDE'
                                             when '700'  then 'AUXILIO_MORADIA'
                                             when '701'  then 'PARTE_TRIBUTAVEL_VALOR_SERVICO_TRANSPORTE_PASSAGEIROS_CARGAS'
                                             when '9011' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_REMUNERACAO_MENSAL'
                                             when '9012' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_DECIMO_TECEIRO_SALARIO'
                                             when '9013' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_FERIAS'
                                             when '9014' then 'EXIGIBILIDADE_SUSPENSA_BASE_CALCULO_IR_PLR'
                                             when '9031' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_REMUNERACAO_MENSAL'
                                             when '9032' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DECIMO_TERCEIRO_SALARIO'
                                             when '9033' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_FERIAS'
                                             when '9034' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_PLR'
                                             when '9831' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_MENSAL'
                                             when '9832' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_DECIMO_TERCEIRO_SALARIO'
                                             when '9833' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_FERIAS'
                                             when '9834' then 'EXIGIBILIDADE_SUSPENSA_RETENCAO_IRRF_DEPOSITO_JUDICIAL_PLR'
                                             when '9041' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_SOCIAL_OFICIAL_PSO_REMUNERACAO_MENSAL'
                                             when '9042' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PSO_DECIMO_TERCEIRO_SALARIO'
                                             when '9043' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PSO_FERIAS'
                                             when '9046' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_SALARIO_MENSAL'
                                             when '9047' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_DECIMO_TERCEIRO_SALARIO'
                                             when '9048' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PREVIDENCIA_PRIVADA_FERIAS'
                                             when '9051' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_REMUNERACAO_MENSAL'
                                             when '9052' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_DECIMO_TERCEIRO_SALARIO'
                                             when '9053' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_FERIAS'
                                             when '9054' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PENSAO_ALIMENTICIA_PLR'
                                             when '9061' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_REMUNERACAO_MENSAL'
                                             when '9062' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_DECIMO_TERCEIRO_SALARIO'
                                             when '9063' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_REMUNERACAO_MENSAL'
                                             when '9064' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_DECIMO_TERCEIRO_SALARIO'
                                             when '9065' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDACAO_PREVIDENCIA_COMPLEMENTAR_SERVIDOR_PUBLICO_FERIAS'
                                             when '9066' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_FUNDO_APOSENTADORIA_PROGRAMADA_INDIVIDUAL_FAPI_FERIAS'
                                             when '9067' then 'EXIGIBILIDADE_SUSPENSA_DEDUCAO_BASE_CALCULO_IRRF_PLANO_PRIVADO_COLETIVO_ASSISTENCIA_SAUDE'
                                          else
                                             null
                                          end,
numeroProcessoIrrfFeriasMes = if incidenciaProcessamentoFerias = 'false' then null
                                                else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
indicativoSuspensaoIrrfFeriasMes =  if incidenciaProcessamentoFerias = 'false' then null
                                                else (select first eh.codigo_suspensao
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'IRF'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaFgtsFeriasMesAux =  if incidenciaProcessamentoFerias = 'false' then null
                                            else (select first eh.incidencia_fgts
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaFgtsFeriasMes = case incidenciaFgtsFeriasMesAux
                                             when '00' then 'NAO_E_BASE_DE_CALCULO_DO_FGTS'
                                             when '11' then 'BASE_DE_CALCULO_DO_FGTS'
                                             when '12' then 'BASE_DE_CALCULO_DO_FGTS_DECIMO_TERCEIRO_SALARIO'
                                             when '21' then 'BASE_DE_CALCULO_DO_FGTS_RESCISORIO_AVISO_PREVIO'
                                             when '91' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                             when '92' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_FGTS_DECIMO_TERCEIRO_SALARIO'
                                             when '93' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_FGTS_AVISO_PREVIO_IDENIZADO'
                                          else
                                             null
                                          end,
numeroProcessoFgtsFeriasMes = if incidenciaProcessamentoFerias = 'false' then null
                                                else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'FGT'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif, 
incidenciaContribuicaoSindicalLaboralFeriasMesAux =   if incidenciaProcessamentoFerias = 'false' then null
                                                                    else  (select first eh.incidencia_contrato_sindical
                                                                       from bethadba.eventos_hist_agrup_esocial eh 
                                                                     where eh.i_eventos = e.i_eventos
                                                                      and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaContribuicaoSindicalLaboralFeriasMes = case incidenciaContribuicaoSindicalLaboralFeriasMesAux
                                                                    when '00' then 'NAO_E_BASE_DE_CALCULO'
                                                                    when '11' then 'BASE_DE_CALCULO'
                                                                    when '31' then 'VALOR_DA_CONTRIBUICAO_SINDICAL_LABORAL_DESCONTADA'
                                                                    when '91' then 'INCIDENCIA_SUSPENSA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                                                 else
                                                                    null
                                                                 end,
incidenciaRppsFeriasMesAux =  if incidenciaProcessamentoFerias = 'false' then null
                                              else  (select first eh.incidencia_rpps
                                                from bethadba.eventos_hist_agrup_esocial eh 
                                              where eh.i_eventos = e.i_eventos
                                                and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
incidenciaRppsFeriasMes = case incidenciaRppsFeriasMesAux
                                             when '00' then 'NAO_E_BASE_DE_CALCULO_DE_CONTRIBUICOES_DEVIDAS_AO_RPPS_REGIME_MILITAR'
                                             when '11' then 'BASE_DE_CALCULO_DE_CONTRIBUICOES_DIVIDAS_AO_RPPS_REGIME_MILITAR'
                                             when '12' then 'BASE_DE_CALCULO_DE_CONTRIBUICOES_DEVIDAS_AO_RPPS_REGIME_MILITAR_DECIMO_TERCEIRO_SALARIO'
                                             when '31' then 'CONTRIBUICAO_DESCONTADA_DO_SEGURADO_E_BENEFICIARIO'
                                             when '32' then 'CONTRIBUICAO_DESCONTADA_DO_SEGURADO_E_BENEFICIARIO_DECIMO_TERCEIRO_SALARIO'
                                             when '91' then 'SUSPENSAO_DE_INCIDENCIA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL'
                                             when '92' then 'SUSPENSAO_DE_INCIDENCIA_EM_DECORRENCIA_DE_DECISAO_JUDICIAL_13_SALARIO'
                                          else
                                             null
                                          end,
numeroProcessoContribuicaoSindicalLaboralFeriasMes = if incidenciaProcessamentoFerias = 'false' then  null
                                               else (select first eh.nr_processo
                                                   from bethadba.eventos_hist_agrup_esocial_proc_isencao eh 
                                                 where eh.i_eventos = e.i_eventos and tipo_isencao = 'CTS'
                                                   and codigo_esocial = cast(e.i_eventos as varchar(4)) + '.2') endif,
codigoRubrica = if incidenciaProcessamentoFerias = 'false' then null else (cast(e.i_eventos as varchar(4)) + '.1') endif,
codigoRubricaFeriasMes = if incidenciaProcessamentoFerias = 'false' then null else (cast(e.i_eventos as varchar(4)) + '.2') endif                                                                                             
                    from bethadba.eventos e  ) as tab
                    //where codigo = 1140; //Para testar algum evento desk
                    where id != 0
"""
